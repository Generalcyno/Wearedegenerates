<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Member Count</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background-color: #181818;
            color: #fff;
        }
        .count-box {
            font-size: 2rem;
            font-weight: bold;
            margin: 20px;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
            background: #282828;
        }
        .total {
            color: #ffcc00;
        }
        .online {
            color: #00ff99;
        }
    </style>
</head>
<body>

    <h1>Discord Server Stats</h1>
    
    <div class="count-box total">
        Total Members: <span id="totalCount">Loading...</span>
    </div>

    <div class="count-box online">
        Online Members: <span id="onlineCount">Loading...</span>
    </div>

    <script>
        async function updateMemberCounts() {
            const response = await fetch("/.netlify/functions/getMembers");
            const data = await response.json();

            animateCount("totalCount", data.total_members);
            animateCount("onlineCount", data.online_members);
        }

        function animateCount(elementId, newCount) {
            let el = document.getElementById(elementId);
            let oldCount = parseInt(el.textContent.replace(/,/g, "")) || 0;

            const animate = () => {
                if (oldCount < newCount) oldCount++;
                else if (oldCount > newCount) oldCount--;

                el.textContent = oldCount.toLocaleString();

                if (oldCount !== newCount) requestAnimationFrame(animate);
            };
            animate();
        }

        setInterval(updateMemberCounts, 30000);
        updateMemberCounts();
    </script>

</body>
</html>
